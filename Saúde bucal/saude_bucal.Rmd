---
title: "Untitled"
author: "Daniel Pagotto"
date: "27/05/2022"
output: html_document
---

```{r setup, include=FALSE}

options(scipen = 999)

knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
library(tidyverse)

if (!require(RODBC)) { install.packages(RODBC); require(RODBC) }

dremio_host <- "200.137.215.27"
dremio_port <- "31010"
dremio_uid <- "daniel"
dremio_pwd <- Sys.getenv("datalake")

channel <- odbcDriverConnect(sprintf("DRIVER=Dremio Connector;HOST=%s;PORT=%s;UID=%s;PWD=%s;AUTHENTICATIONTYPE=Basic Authentication;CONNECTIONTYPE=Direct", dremio_host, dremio_port, dremio_uid, dremio_pwd))

df_sb <- sqlQuery(channel, 'SELECT * FROM "Analytics Layer".Territorial."População IBGE por estado e faixa etária selecionada"')

```

# Prototipação

Para fins de prototipação, vamos pegar só dados de Goiânia. 

```{r}

a <- df_sb %>%  
  filter(uf == 'GO') %>% 
  ggplot(aes(x = ano, y = TOTAL, col = FAIXA_ETARIA)) + geom_line(size = 1) + 
  theme_minimal()

plotly::ggplotly(a)

```


De acordo com o caderno de critérios e parâmetros temos algumas previsões sobre a necessidade de procedimentos. A imagem abaixo apresenta tais condições 

![Quadro 1 - procedimentos por faixas etárias](quadro1.PNG)
![Quadro 2 - procedimentos por faixas etárias](quadro2.PNG)
![Quadro 3 - procedimentos por faixas etárias](quadro3.PNG)
![Quadro 4 - procedimentos por faixas etárias](quadro4.PNG)



